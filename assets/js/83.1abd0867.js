(window.webpackJsonp=window.webpackJsonp||[]).push([[83],{496:function(s,e,a){"use strict";a.r(e);var n=a(2),r=Object(n.a)({},(function(){var s=this,e=s._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"nginx"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#nginx"}},[s._v("#")]),s._v(" Nginx")]),s._v(" "),e("h2",{attrs:{id:"q-域名如何绑定ip-端口"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#q-域名如何绑定ip-端口"}},[s._v("#")]),s._v(" Q: 域名如何绑定ip+端口?")]),s._v(" "),e("blockquote",[e("p",[s._v("如何把 域名绑定到IP+端口的地址上， 域名xxx.com只能对应ip 1.2.3.4，nginx默认80端口，假设我现在是访问xxx.com,那其实就>是 1.2.3.4:80，有没有办法让 a.xxx.com 访问 1.2.3.4:8000，b.xxx.com 访问 1.2.3.4:9000")])]),s._v(" "),e("p",[s._v("要实现将不同的子域名 ("),e("code",[s._v("a.xxx.com")]),s._v(" 和 "),e("code",[s._v("b.xxx.com")]),s._v(") 映射到不同的端口（如 "),e("code",[s._v("1.2.3.4:8000")]),s._v(" 和 "),e("code",[s._v("1.2.3.4:9000")]),s._v("），你可以使用 Nginx 作为反向代理来完成这一任务。具体步骤如下：")]),s._v(" "),e("h3",{attrs:{id:"_1-配置-dns"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-配置-dns"}},[s._v("#")]),s._v(" 1. 配置 DNS")]),s._v(" "),e("p",[s._v("首先，你需要确保你的域名 "),e("code",[s._v("xxx.com")]),s._v(" 的 DNS 记录正确设置。通常，DNS 设置会将 "),e("code",[s._v("xxx.com")]),s._v(" 和 "),e("code",[s._v("a.xxx.com")]),s._v("、"),e("code",[s._v("b.xxx.com")]),s._v(" 等子域名指向相同的 IP 地址 "),e("code",[s._v("1.2.3.4")]),s._v("。例如，你可以在你的 DNS 提供商（如 Cloudflare、AWS Route 53 等）中添加以下记录：")]),s._v(" "),e("ul",[e("li",[e("code",[s._v("xxx.com")]),s._v(" -> "),e("code",[s._v("1.2.3.4")]),s._v("（默认的域名）")]),s._v(" "),e("li",[e("code",[s._v("a.xxx.com")]),s._v(" -> "),e("code",[s._v("1.2.3.4")]),s._v("（指向同一 IP）")]),s._v(" "),e("li",[e("code",[s._v("b.xxx.com")]),s._v(" -> "),e("code",[s._v("1.2.3.4")]),s._v("（指向同一 IP）")])]),s._v(" "),e("h3",{attrs:{id:"_2-配置-nginx"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-配置-nginx"}},[s._v("#")]),s._v(" 2. 配置 Nginx")]),s._v(" "),e("p",[s._v("Nginx 可以通过基于请求的 Host 头 来区分不同的子域名，并将请求转发到不同的端口。你需要编辑 Nginx 的配置文件来设置这一行为。")]),s._v(" "),e("h4",{attrs:{id:"步骤-1-编辑-nginx-配置文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#步骤-1-编辑-nginx-配置文件"}},[s._v("#")]),s._v(" 步骤 1：编辑 Nginx 配置文件")]),s._v(" "),e("p",[s._v("打开 Nginx 配置文件，通常位于 "),e("code",[s._v("/etc/nginx/nginx.conf")]),s._v(" 或 "),e("code",[s._v("/etc/nginx/sites-available/default")]),s._v("，然后添加如下内容：")]),s._v(" "),e("div",{staticClass:"language-conf line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# 默认配置，处理 xxx.com 的请求（可以指向端口 80）\nserver {\n    listen 80;\n    server_name xxx.com;\n\n    location / {\n        proxy_pass http://127.0.0.1:80;  # 默认的端口80\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n\n# a.xxx.com 的配置，转发到 1.2.3.4:8000\nserver {\n    listen 80;\n    server_name a.xxx.com;\n\n    location / {\n        proxy_pass http://127.0.0.1:8000;  # 转发到 8000 端口\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n\n# b.xxx.com 的配置，转发到 1.2.3.4:9000\nserver {\n    listen 80;\n    server_name b.xxx.com;\n\n    location / {\n        proxy_pass http://127.0.0.1:9000;  # 转发到 9000 端口\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br")])]),e("h4",{attrs:{id:"步骤-2-重启-nginx"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#步骤-2-重启-nginx"}},[s._v("#")]),s._v(" 步骤 2：重启 Nginx")]),s._v(" "),e("p",[s._v("保存并退出编辑器后，重启 Nginx 服务使配置生效：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl restart nginx\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"_3-解释配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-解释配置"}},[s._v("#")]),s._v(" 3. 解释配置")]),s._v(" "),e("ul",[e("li",[e("code",[s._v("server_name")]),s._v("：每个 "),e("code",[s._v("server")]),s._v(" 块根据 "),e("code",[s._v("server_name")]),s._v(" 匹配请求的主机名。Nginx 会根据请求的 "),e("code",[s._v("Host")]),s._v(" 头来确定应该匹配哪个 "),e("code",[s._v("server")]),s._v(" 块。")]),s._v(" "),e("li",[e("code",[s._v("location /")]),s._v("：匹配根路径的所有请求，并通过 "),e("code",[s._v("proxy_pass")]),s._v(" 将请求转发到不同的端口（8000 或 9000）。")]),s._v(" "),e("li",[e("code",[s._v("proxy_pass")]),s._v("：将请求转发到指定的端口。在这个例子中，"),e("code",[s._v("a.xxx.com")]),s._v(" 会转发到 "),e("code",[s._v("http://127.0.0.1:8000")]),s._v("，而 "),e("code",[s._v("b.xxx.com")]),s._v(" 会转发到 "),e("code",[s._v("http://127.0.0.1:9000")]),s._v("。")]),s._v(" "),e("li",[e("code",[s._v("proxy_set_header")]),s._v("：这些设置是为了确保请求头正确传递，包括真实的客户端 IP 地址等信息。")])]),s._v(" "),e("h3",{attrs:{id:"_4-验证"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-验证"}},[s._v("#")]),s._v(" 4. 验证")]),s._v(" "),e("p",[s._v("完成上述配置后，你可以通过以下方式验证：")]),s._v(" "),e("ul",[e("li",[s._v("访问 "),e("code",[s._v("http://a.xxx.com")]),s._v("，它应该转发到 "),e("code",[s._v("1.2.3.4:8000")]),s._v("。")]),s._v(" "),e("li",[s._v("访问 "),e("code",[s._v("http://b.xxx.com")]),s._v("，它应该转发到 "),e("code",[s._v("1.2.3.4:9000")]),s._v("。")])]),s._v(" "),e("h3",{attrs:{id:"总结"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[s._v("#")]),s._v(" 总结")]),s._v(" "),e("ul",[e("li",[s._v("DNS 配置：确保 "),e("code",[s._v("a.xxx.com")]),s._v(" 和 "),e("code",[s._v("b.xxx.com")]),s._v(" 都指向 "),e("code",[s._v("1.2.3.4")]),s._v("。")]),s._v(" "),e("li",[s._v("Nginx 配置：在 Nginx 中使用 "),e("code",[s._v("server_name")]),s._v(" 来区分不同的子域名，然后使用 "),e("code",[s._v("proxy_pass")]),s._v(" 将请求转发到不同的端口。")]),s._v(" "),e("li",[s._v("重启 Nginx：使配置生效。")])]),s._v(" "),e("p",[s._v("这样，你就能够实现不同的子域名访问不同的端口，而无需暴露不同的 IP 地址。")])])}),[],!1,null,null,null);e.default=r.exports}}]);